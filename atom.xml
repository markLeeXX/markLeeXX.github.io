<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>mark&#39;s BLOG</title>
  
  <subtitle>Android开发者</subtitle>
  <link href="http://hookandroid.com/atom.xml" rel="self"/>
  
  <link href="http://hookandroid.com/"/>
  <updated>2020-11-05T02:42:33.740Z</updated>
  <id>http://hookandroid.com/</id>
  
  <author>
    <name>mark</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>frida使用教程</title>
    <link href="http://hookandroid.com/post/frida_use.html"/>
    <id>http://hookandroid.com/post/frida_use.html</id>
    <published>2020-11-04T10:54:54.000Z</published>
    <updated>2020-11-05T02:42:33.740Z</updated>
    
    <content type="html"><![CDATA[<h3 id="hook代码"><a href="#hook代码" class="headerlink" title="hook代码"></a>hook代码</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> frida</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="comment"># hook代码，采用javascript编写</span></span><br><span class="line">jscode = <span class="string">"""</span></span><br><span class="line"><span class="string">//javascript代码，重点</span></span><br><span class="line"><span class="string">Java.perform(function () &#123;</span></span><br><span class="line"><span class="string">    var apkParseCompat = Java.use('com.hookandroid.apk.library.ApkParseCompat');</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    apkParseCompat.isExitPackage.implementation = function(packageName)&#123;</span></span><br><span class="line"><span class="string">        send("hook start isExitPackage...");</span></span><br><span class="line"><span class="string">        send("参数1：" + packageName);</span></span><br><span class="line"><span class="string">        return true;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#125;);</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># 自定义回调函数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">on_message</span><span class="params">(message, data)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> message[<span class="string">'type'</span>] == <span class="string">'send'</span>:</span><br><span class="line">        print(<span class="string">"[*] &#123;0&#125;"</span>.format(message[<span class="string">'payload'</span>]))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(message)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重点的4行代码</span></span><br><span class="line">process = frida.get_remote_device().attach(<span class="string">'com.hookandroid.apk.sample'</span>)</span><br><span class="line">script = process.create_script(jscode)</span><br><span class="line">script.on(<span class="string">'message'</span>, on_message)</span><br><span class="line">script.load()</span><br><span class="line">sys.stdin.read()</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;hook代码&quot;&gt;&lt;a href=&quot;#hook代码&quot; class=&quot;headerlink&quot; title=&quot;hook代码&quot;&gt;&lt;/a&gt;hook代码&lt;/h3&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gu</summary>
      
    
    
    
    
    <category term="Android" scheme="http://hookandroid.com/tags/Android/"/>
    
    <category term="逆向" scheme="http://hookandroid.com/tags/%E9%80%86%E5%90%91/"/>
    
    <category term="frida" scheme="http://hookandroid.com/tags/frida/"/>
    
  </entry>
  
  <entry>
    <title>frida安装教程</title>
    <link href="http://hookandroid.com/post/frida_install.html"/>
    <id>http://hookandroid.com/post/frida_install.html</id>
    <published>2020-11-04T07:36:27.000Z</published>
    <updated>2020-11-05T02:29:10.341Z</updated>
    
    <content type="html"><![CDATA[<p>需要安装python3，及已获取root权限手机或模拟器。</p><a id="more"></a><h3 id="安装python3"><a href="#安装python3" class="headerlink" title="安装python3"></a>安装python3</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;www.python.org&#x2F;downloads&#x2F;release&#x2F;python-360&#x2F;</span><br><span class="line"></span><br><span class="line">配置环境变量</span><br></pre></td></tr></table></figure><h3 id="安装frida"><a href="#安装frida" class="headerlink" title="安装frida"></a>安装frida</h3><h4 id="更新pip"><a href="#更新pip" class="headerlink" title="更新pip"></a>更新pip</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">确认pip</span><br><span class="line">python -m ensurepip</span><br><span class="line"></span><br><span class="line">更新pip</span><br><span class="line">python -m pip install --upgrade pip</span><br><span class="line"></span><br><span class="line">安装wheel</span><br><span class="line">pip install wheel</span><br></pre></td></tr></table></figure><h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">推荐FRIDA稳定版</span><br><span class="line">pip install frida&#x3D;&#x3D;12.8.0</span><br><span class="line">pip install frida-tools&#x3D;&#x3D;5.3.0</span><br><span class="line">pip install objection&#x3D;&#x3D;1.8.4</span><br><span class="line">以上安装需要科学上网</span><br></pre></td></tr></table></figure><h3 id="运行frida-server"><a href="#运行frida-server" class="headerlink" title="运行frida-server"></a>运行frida-server</h3><h4 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;github.com&#x2F;frida&#x2F;frida&#x2F;releases</span><br><span class="line"></span><br><span class="line">含图形化页面服务端</span><br><span class="line">https:&#x2F;&#x2F;github.com&#x2F;wrlu&#x2F;FridaHooker</span><br></pre></td></tr></table></figure><h4 id="推送到模拟器"><a href="#推送到模拟器" class="headerlink" title="推送到模拟器"></a>推送到模拟器</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">adb push frida-server-12.8.0-android-x86 &#x2F;data&#x2F;local&#x2F;frida-server</span><br><span class="line">su</span><br><span class="line">chmod 777 frida-server</span><br><span class="line">.&#x2F;frida-server</span><br></pre></td></tr></table></figure><h3 id="检测运行状态"><a href="#检测运行状态" class="headerlink" title="检测运行状态"></a>检测运行状态</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">frida-ps -Ua</span><br><span class="line">出现进程列表，表示连接成功</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;需要安装python3，及已获取root权限手机或模拟器。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Android" scheme="http://hookandroid.com/tags/Android/"/>
    
    <category term="逆向" scheme="http://hookandroid.com/tags/%E9%80%86%E5%90%91/"/>
    
    <category term="frida" scheme="http://hookandroid.com/tags/frida/"/>
    
  </entry>
  
  <entry>
    <title>adb常用命令</title>
    <link href="http://hookandroid.com/post/adb.html"/>
    <id>http://hookandroid.com/post/adb.html</id>
    <published>2020-11-03T10:24:39.000Z</published>
    <updated>2020-11-05T03:14:37.938Z</updated>
    
    <content type="html"><![CDATA[<h4 id="卸载系统应用"><a href="#卸载系统应用" class="headerlink" title="卸载系统应用"></a>卸载系统应用</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">adb shell pm uninstall [-k] [--user USER_ID] 包名</span><br><span class="line">参数说明：</span><br><span class="line">-k 卸载应用且保留数据与缓存，如果不加 -k 则全部删除。</span><br><span class="line">--user 指定用户 id，Android 系统支持多个用户，默认用户只有一个，id&#x3D;0。</span><br><span class="line">可以用这个命令，user 和 debug 版本都可以用，所有应用都能卸载掉。</span><br><span class="line"></span><br><span class="line">比如这里卸载 360 浏览器：</span><br><span class="line">adb shell pm uninstall -k --user 0 com.qihoo.browser</span><br><span class="line"></span><br><span class="line">恢复安装</span><br><span class="line">adb shell pm install-existing --user 0 com.qihoo.browser</span><br></pre></td></tr></table></figure><h4 id="debug模式启动apk"><a href="#debug模式启动apk" class="headerlink" title="debug模式启动apk"></a>debug模式启动apk</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">adb shell am start -D -n com.ali.tg.testapp&#x2F;.MainActivity</span><br><span class="line"></span><br><span class="line">等待debug</span><br><span class="line">adb shell am set-debug-app -w com.example.jishuxiaoheiwu.appdebugsample</span><br><span class="line"></span><br><span class="line">设置持久debug</span><br><span class="line">adb shell am set-debug-app -w --persistent  com.example.jishuxiaoheiwu.appdebugsample</span><br><span class="line"></span><br><span class="line">清除持久debug</span><br><span class="line">adb shell am clear-debug-app</span><br></pre></td></tr></table></figure><h4 id="查看栈顶Activity"><a href="#查看栈顶Activity" class="headerlink" title="查看栈顶Activity"></a>查看栈顶Activity</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">adb shell dumpsys activity top | findstr ACTIVITY</span><br><span class="line"></span><br><span class="line">adb shell dumpsys activity top | findstr pid</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h4 id=&quot;卸载系统应用&quot;&gt;&lt;a href=&quot;#卸载系统应用&quot; class=&quot;headerlink&quot; title=&quot;卸载系统应用&quot;&gt;&lt;/a&gt;卸载系统应用&lt;/h4&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gut</summary>
      
    
    
    
    
    <category term="adb" scheme="http://hookandroid.com/tags/adb/"/>
    
  </entry>
  
  <entry>
    <title>Git基础教程</title>
    <link href="http://hookandroid.com/post/git.html"/>
    <id>http://hookandroid.com/post/git.html</id>
    <published>2020-11-03T06:24:25.000Z</published>
    <updated>2020-11-03T09:27:53.622Z</updated>
    
    <content type="html"><![CDATA[<h3 id="初始化配置"><a href="#初始化配置" class="headerlink" title="初始化配置"></a>初始化配置</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name &quot;markLee&quot;</span><br><span class="line">git config --global user.email &quot;946768930@qq.com&quot;</span><br></pre></td></tr></table></figure><h3 id="初始化仓库"><a href="#初始化仓库" class="headerlink" title="初始化仓库"></a>初始化仓库</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git init</span><br></pre></td></tr></table></figure><h3 id="基本操作"><a href="#基本操作" class="headerlink" title="基本操作"></a>基本操作</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 添加文件到暂存区，可以多次添加多种文件</span><br><span class="line">git add .</span><br></pre></td></tr></table></figure><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="git/提交.jpg" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 提交文件到分支</span><br><span class="line">git commit -m &quot;版本更新&quot;</span><br></pre></td></tr></table></figure><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="git/添加.jpg" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><p>```</p><p>// 查看当前仓库状态<br>git status</p><p>// 查看精简日志<br>git log –pretty=oneline</p><p>// 查看曾经输入的所有命令<br>git reflog</p><p>// 回退到指定commit<br>git reset –hard 887ef6b</p><p>// 回退到上一次commit<br>git reset –hard HEAD^</p><p>// 查看工作区和版本库内容区别<br>git diff HEAD – readme.txt</p><p>// 撤销修改<br>1.git add之后撤销，回退到add后状态<br>2.git add之前撤销，和版本库状态一样<br>git checkout – readme.txt</p><p>// 删除文件<br>git rm read.txt</p><p>// 生成公钥<br>ssh-keygen -t rsa -C “<a href="mailto:youremail@example.com">youremail@example.com</a>“</p><p>// 关联远程仓库<br>git remote add origin <a href="mailto:git@github.com">git@github.com</a>:michaelliao/learngit.git</p><p>// 删除远程仓库关联<br>git remote rm origin</p><p>// 推送代码<br>// -u 表达本地分支和远程分支相关联<br>git push -u origin master</p><p>// Linux与Windows换行符<br>git config –global core.autocrlf false</p><p>// 创建分支并切换<br>git checkout -b dev<br>git switch -c dev</p><p>// 创建本地及远程分支<br>git checkout -b dev origin/dev</p><p>// 列出所有分支<br>git branch</p><p>// 删除指定分支<br>git branch -d dev<br>git branch -D dev 强行删除，丢失未提交数据</p><p>// 把dev分支合并到当前分支<br>git merge dev</p><p>// 查看分支合并图<br>git log –graph</p><p>// 合并分支关闭fast forward模式<br>git merge –no-ff -m “merged bug fix 101” issue-101</p><p>// 当前分支已修改文件缓存一下<br>git stash</p><p>git stash list 查看当前缓存<br>git stash apply 恢复缓存<br>git stash drop 删除缓存<br>git stash pop 恢复并删除</p><p>git stash apply stash@{0} 恢复指定缓存</p><p>// 迁移指定commit<br>git cherry-pick 4c805e2</p><p>// 查看远程分支<br>git remote<br>git remote -v 详细信息</p><p>// 推送分支<br>git push origin master</p><p>// 本地分支关联远程分支<br>git branch –set-upstream-to=origin/dev dev</p><p>// 对指定提交打标签<br>git tag v0.9 f52c633</p><p>// 推送指定标签到远程仓库<br>git push origin v1.0</p><p>// 推送所有标签到远程仓库<br>git push origin –tags</p><p>// 删除指定标签<br>git tag -d v1.0</p><p>// 删除远程指定标签<br>git push origin:/refs/tags/v1.0</p><p>// 配置git命令别名<br>git config –global alias.st status</p><p>git config –global alias.lg “log –color –graph –pretty=format:’%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)&lt;%an&gt;%Creset’ –abbrev-commit”</p><p>```w</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;初始化配置&quot;&gt;&lt;a href=&quot;#初始化配置&quot; class=&quot;headerlink&quot; title=&quot;初始化配置&quot;&gt;&lt;/a&gt;初始化配置&lt;/h3&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;</summary>
      
    
    
    
    
    <category term="Git" scheme="http://hookandroid.com/tags/Git/"/>
    
    <category term="版本控制" scheme="http://hookandroid.com/tags/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/"/>
    
  </entry>
  
  <entry>
    <title>Android设备CPU架构兼容性</title>
    <link href="http://hookandroid.com/post/android_cpu.html"/>
    <id>http://hookandroid.com/post/android_cpu.html</id>
    <published>2020-11-02T02:37:50.000Z</published>
    <updated>2020-11-03T04:26:32.888Z</updated>
    
    <content type="html"><![CDATA[<p>CPU设备兼容性</p><a id="more"></a><p>armeabi设备只兼容armeabi；</p><p>armeabi-v7a设备兼容armeabi-v7a、armeabi；</p><p>arm64-v8a设备兼容arm64-v8a、armeabi-v7a、armeabi；</p><p>X86设备兼容X86、armeabi；</p><p>X86_64设备兼容X86_64、X86、armeabi；</p><p>mips64设备兼容mips64、mips；</p><p>mips只兼容mips；</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;CPU设备兼容性&lt;/p&gt;</summary>
    
    
    
    <category term="Android" scheme="http://hookandroid.com/categories/Android/"/>
    
    
    <category term="Android" scheme="http://hookandroid.com/tags/Android/"/>
    
    <category term="CPU" scheme="http://hookandroid.com/tags/CPU/"/>
    
  </entry>
  
</feed>
